import random
from telegram import Update
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    ContextTypes
)

TOKEN = "PASTE_YOUR_BOT_TOKEN_HERE"

# –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏–≥—Ä–æ–∫–æ–≤
users = {}

class Manager:
    def __init__(self, name):
        self.name = name
        self.team = random.choice([
            "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞", "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥", "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥",
            "–ë–∞–≤–∞—Ä–∏—è", "–ü–°–ñ", "–Æ–≤–µ–Ω—Ç—É—Å"
        ])
        self.points = 0
        self.matches = 0

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    name = update.effective_user.first_name

    if user_id not in users:
        users[user_id] = Manager(name)
        text = (
            f"‚öΩ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {name}!\n\n"
            f"–¢—ã —Å—Ç–∞–ª –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∫–ª—É–±–∞: üèü {users[user_id].team}\n"
            f"–ò—Å–ø–æ–ª—å–∑—É–π /match —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –º–∞—Ç—á\n"
            f"/stats ‚Äî —Ç–≤–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
        )
    else:
        text = "–¢—ã —É–∂–µ –º–µ–Ω–µ–¥–∂–µ—Ä üòâ –ò—Å–ø–æ–ª—å–∑—É–π /match –∏–ª–∏ /stats"

    await update.message.reply_text(text)

async def match(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id

    if user_id not in users:
        await update.message.reply_text("–°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏ /start")
        return

    manager = users[user_id]
    manager.matches += 1

    result = random.choice(["win", "draw", "lose"])

    if result == "win":
        manager.points += 3
        text = "üèÜ –ü–æ–±–µ–¥–∞! +3 –æ—á–∫–∞"
    elif result == "draw":
        manager.points += 1
        text = "ü§ù –ù–∏—á—å—è! +1 –æ—á–∫–æ"
    else:
        text = "‚ùå –ü–æ—Ä–∞–∂–µ–Ω–∏–µ. 0 –æ—á–∫–æ–≤"

    await update.message.reply_text(
        f"‚öΩ –ú–∞—Ç—á —Å—ã–≥—Ä–∞–Ω!\n{text}"
    )

async def stats(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id

    if user_id not in users:
        await update.message.reply_text("–°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏ /start")
        return

    m = users[user_id]
    await update.message.reply_text(
        f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞\n\n"
        f"üë§ –ò–º—è: {m.name}\n"
        f"üèü –ö–ª—É–±: {m.team}\n"
        f"üéÆ –ú–∞—Ç—á–µ–π: {m.matches}\n"
        f"‚≠ê –û—á–∫–∏: {m.points}"
    )

def main():
    app = ApplicationBuilder().token(TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("match", match))
    app.add_handler(CommandHandler("stats", stats))

    print("‚öΩ Football Manager Bot –∑–∞–ø—É—â–µ–Ω")
    app.run_polling()

if __name__ == "__main__":
    main()
    
